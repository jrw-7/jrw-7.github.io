<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<style> circle {fill: lightblue; stroke: black;} </style>

<style>
.chart rect { fill: steelblue; }
#tooltip {
    position: absolute;			
    width: 200px;					
    height: 50px;					
    padding: 2px;				
    font: 12px sans-serif;		
    background: white;	
    border: 0px;		
    pointer-events: none;
}
</style>


<body onload='init()'>
<h1>The Rise and Fall of the Chicago Bulls 1978-2003</h1>

<p>
Next, in 1988, the organization hired Phil Jackson as head coach and added a
strong supporting cast which helped them maintain a win/loss percent above 0.500.
They also went on to win 6 NBA championships in '90,'91,'92, and '95,'96,'97.
However, that run comes to an end after the '97 season.
</p>    

<svg width=1000 height=1000></svg>

<div id="tooltip"></div>

<script>

async function init() {
    
    var tooltip = d3.select("#tooltip");
//
const dat = await d3.csv('https://jrw-7.github.io/nba_bulls_csv_final.csv');

var data = dat.filter(filterCriteria);

function filterCriteria(d) {
    return (
      d.Season === "1978" || 
      d.Season === "1979" ||
      d.Season === "1980" ||
      d.Season === "1981" || 
      d.Season === "1982" ||
      d.Season === "1983" ||
      d.Season === "1984" ||
      d.Season === "1985" ||
      d.Season === "1986" ||
      d.Season === "1987" ||
      d.Season === "1988" ||
      d.Season === "1989" ||
      d.Season === "1990" ||
      d.Season === "1991" ||
      d.Season === "1992" ||
      d.Season === "1993" ||
      d.Season === "1994" ||
      d.Season === "1995" ||
      d.Season === "1996" ||
      d.Season === "1997"
      );
}

  // When reading the csv, I must format variables:

// set the dimensions and margins of the graph
var width = 800,
    height = 800;


// Add X axis --> YEAR
var x = d3.scaleTime()
      .domain(d3.extent(data, function(d) { return new Date(parseInt(d.Season),0); }))
      .range([ 0, width ]);

// Add Y axis
var y = d3.scaleLinear()
      .domain([0, 0.9])
      .range([ height, 0 ]);

d3.select('svg').append("g")
  .attr("transform", "translate(100,100)")
  .selectAll('circle')
  .data(data)
  .enter()
  .append('circle')
    .attr("cx", function(d) { return x(new Date(parseInt(d.Season),0)); })
    .attr("cy", function(d) { return y(d.Win_Loss_Percent); })
    .attr("r", function(d) { return 6; })
    .on("mouseover", function(d,i) {
        tooltip.style("opacity", 1)
               .style("left",(d3.event.pageX)+"px")
               .style("top",(d3.event.pageY)+"px")
               .html("Win/Loss: "+ d.Win_Loss_Percent + 
               "<br> Year: " + d.Season + "<br> Coaches: " + d.Coaches
               + "<br> FG%: " + d.Coaches
               
               
               );
    })
    .on("mouseout", function() { tooltip.style("opacity", 0) })
    

d3.select('svg').append("g")
  .attr("transform", "translate(100,100)")
    // Add the line
  .append("path")
      .datum(data)
      .attr("fill", "none")
      .attr("stroke", "steelblue")
      .attr("stroke-width", 1.5)
      .attr("d", d3.line()
        .x(function(d) { return x(new Date(parseInt(d.Season),0)); })
        .y(function(d) { return y(d.Win_Loss_Percent) })
        )




//X
d3.select("svg").append("g")
      .attr("transform", "translate(100,900)")
      .call(d3.axisBottom(x).tickFormat(d => d.getFullYear()));
//Y
d3.select("svg").append("g")
    .attr("transform", "translate(100,100)")
    .call(d3.axisLeft(y).tickFormat(function (d){
    return d3.format(".3f")(d);}));


// Annotation
d3.select("svg").append("text")
      .text("Michael Jordan is drafted.")
          .attr("transform", "translate(50, 100)")
    .attr("x", x(new Date(parseInt("1984"),0)))
    .attr("y", 620);
    

d3.select("svg").append("line")
    .style("stroke", "black")
    .style("stroke-width", 1)
    .attr("transform", "translate(100, 100)")
    .attr("x1", x(new Date(parseInt("1984"),0)))
    .attr("y1", 395)
    .attr("x2", x(new Date(parseInt("1984"),0)))
    .attr("y2", 600);
    
d3.select("svg").append("text")
      .text("Win first NBA Championship")
      .attr("transform", "translate(50, 100)")
    .attr("x", x(new Date(parseInt("1990"),0)))
    .attr("y", 550);

d3.select("svg").append("line")
    .style("stroke", "black")
    .style("stroke-width", 1)
    .attr("transform", "translate(100, 100)")
    .attr("x1", x(new Date(parseInt("1990"),0)))
    .attr("y1", y(.744))
    .attr("x2", x(new Date(parseInt("1990"),0)))
    .attr("y2", 540);

// X Axis Label
d3.select("svg").append("text")
      .text("W/L %")
    .attr("x", 0)
    .attr("y", 400);

// Y Axis Label
d3.select("svg").append("text")
      .text("Season (Year)")
    .attr("x", 500)
    .attr("y", 950);

}



    

</script>
</body>
</html>


