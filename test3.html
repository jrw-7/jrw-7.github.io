<html>

<script src='https://d3js.org/d3.v5.min.js'></script>
<style> circle {fill: lightblue; stroke: black;} </style>

<style>
.chart rect { fill: steelblue; }
#tooltip {
    position: absolute;			
    width: 200px;					
    height: 50px;					
    padding: 2px;				
    font: 12px sans-serif;		
    background: white;	
    border: 0px;		
    pointer-events: none;
}
</style>


<body onload='init()'>
<h1>The Rise and Fall of the Chicago Bulls 1978-2003</h1>

<p>
Lastly, we see the fall -- the end of an era. In 1998, Michael Jordan retires
for good, and head coach Phil Jackson leaves. With the core team decimated,
the record plummets to below 0.500 during the '98 season and stays below through
2003, leaving the organization to look towards rebuilding for the future.
</p>    
<a href='https://jrw-7.github.io/index.html'><button>Scene 1</button></a>
<a href='https://jrw-7.github.io/test2.html'><button>Scene 2</button></a>
<a href='https://jrw-7.github.io/test3.html'><button>Scene 3</button></a>
<br>
</br>
<svg width=1000 height=1000></svg>

<div id="tooltip"></div>

<script>

async function init() {
    
    var tooltip = d3.select("#tooltip");
//
const dat = await d3.csv('https://jrw-7.github.io/nba_bulls_csv_final.csv');

var data = dat.filter(filterCriteria);

function filterCriteria(d) {
    return d.Season;
}

  // When reading the csv, I must format variables:

// set the dimensions and margins of the graph
var width = 800,
    height = 800;


// Add X axis --> YEAR
var x = d3.scaleTime()
      .domain(d3.extent(data, function(d) { return new Date(parseInt(d.Season),0); }))
      .range([ 0, width ]);

// Add Y axis
var y = d3.scaleLinear()
      .domain([0, 0.9])
      .range([ height, 0 ]);

d3.select('svg').append("g")
  .attr("transform", "translate(100,100)")
  .selectAll('circle')
  .data(data)
  .enter()
  .append('circle')
    .attr("cx", function(d) { return x(new Date(parseInt(d.Season),0)); })
    .attr("cy", function(d) { return y(d.Win_Loss_Percent); })
    .attr("r", function(d) { return 6; })
    .on("mouseover", function(d,i) {
        tooltip.style("opacity", 1)
               .style("left",(d3.event.pageX)+"px")
               .style("top",(d3.event.pageY)+"px")
               .html("Win/Loss: "+ d.Win_Loss_Percent + 
               "<br> Year: " + d.Season + "<br> Coaches: " + d.Coaches
               + "<br> FG%: " + d.Coaches
               
               
               );
    })
    .on("mouseout", function() { tooltip.style("opacity", 0) })
    

d3.select('svg').append("g")
  .attr("transform", "translate(100,100)")
    // Add the line
  .append("path")
      .datum(data)
      .attr("fill", "none")
      .attr("stroke", "steelblue")
      .attr("stroke-width", 1.5)
      .attr("d", d3.line()
        .x(function(d) { return x(new Date(parseInt(d.Season),0)); })
        .y(function(d) { return y(d.Win_Loss_Percent) })
        )


//X
d3.select("svg").append("g")
      .attr("transform", "translate(100,900)")
      //.attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x).tickFormat(d => d.getFullYear()));
//Y
d3.select("svg").append("g")
    .attr("transform", "translate(100,100)")
    .call(d3.axisLeft(y).tickFormat(function (d){
    return d3.format(".3f")(d);}));


// Annotation
d3.select("svg").append("text")
      .text("Michael Jordan is drafted.")
          .attr("transform", "translate(50, 100)")
    .attr("x", x(new Date(parseInt("1984"),0)))
    .attr("y", 620);
    

d3.select("svg").append("line")
    .style("stroke", "black")
    .style("stroke-width", 1)
    .attr("transform", "translate(100, 100)")
    .attr("x1", x(new Date(parseInt("1984"),0)))
    .attr("y1", 395)
    .attr("x2", x(new Date(parseInt("1984"),0)))
    .attr("y2", 600);
    
d3.select("svg").append("text")
      .text("Win first NBA Championship")
      .attr("transform", "translate(50, 100)")
    .attr("x", x(new Date(parseInt("1990"),0)))
    .attr("y", 550);

d3.select("svg").append("line")
    .style("stroke", "black")
    .style("stroke-width", 1)
    .attr("transform", "translate(100, 100)")
    .attr("x1", x(new Date(parseInt("1990"),0)))
    .attr("y1", y(.744))
    .attr("x2", x(new Date(parseInt("1990"),0)))
    .attr("y2", 540);


d3.select("svg").append("text")
    .attr("transform", "translate(50, 100)")
      .text("MJ and Coach Jackson leave.")
    .attr("x", x(new Date(parseInt("1998"),0)))
    .attr("y", 750);

d3.select("svg").append("line")
    .style("stroke", "black")
    .style("stroke-width", 1)
    .attr("transform", "translate(100, 100)")
    .attr("x1", x(new Date(parseInt("1998"),0)))
    .attr("y1", y(.260))
    .attr("x2", x(new Date(parseInt("1998"),0)))
    .attr("y2", 740);

// X Axis Label
d3.select("svg").append("text")
      .text("W/L %")
    .attr("x", 0)
    .attr("y", 400);

// Y Axis Label
d3.select("svg").append("text")
      .text("Season (Year)")
    .attr("x", 500)
    .attr("y", 950);
}

</script>
</body>
</html>


